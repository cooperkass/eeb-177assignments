# 1 files combined:
# 	/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/pyrate_mcmc_logs/canid_occ_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/pyrate_mcmc_logs/canid_occ_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.150724352262, 0.150724352262,0.150724352262,0.117234681519,0.0651955186351,0.0574879291004,0.0473110100101,0.0473110100101,0.0501428703296,0.0484626492852,0.0473110100101,0.0473110100101,0.0473110100101,0.0473110100101,0.0473110100101,0.0473110100101,0.0572107587184,0.0623837896281,0.0746185485999,0.0746185485999,0.0746185485999,0.0954204444863,0.0954204444863,0.0954204444863,0.0957073834135,0.0957073834135,0.0954204444863,0.0954204444863,0.0954204444863,0.0954204444863,0.106195831375,0.110530111831,0.110530111831,0.144845503339,0.144845503339,0.142347517083,0.142347517083,0.144845503339,0.142347517083,0.142347517083,0.142347517083,0.132394357355,0.144845503339,0.136844060591,0.0875666634712,0.0875666634712,0.0648474056991,0.0648474056991,0.0648474056991,0.0648474056991,0.0648474056991,0.0648474056991,0.0648474056991,0.0648474056991)
L_hpd_M95=c(0.373248754376, 0.373248754376,0.374107486199,0.377206247686,0.351834010727,0.315646849306,0.20289092337,0.154305462933,0.152533481412,0.144962374187,0.137367769062,0.134705788289,0.134705788289,0.134705788289,0.134705788289,0.144962374187,0.160179442465,0.166692536679,0.183190935214,0.188296443335,0.186094972193,0.200015994251,0.198760190431,0.200015994251,0.209247146313,0.209247146313,0.209247146313,0.211733618586,0.239819208518,0.311961687342,0.371847205705,0.374611016435,0.374611016435,0.396584275261,0.396584275261,0.396584275261,0.392349156855,0.396584275261,0.403932078438,0.409853843349,0.409853843349,0.409853843349,0.426773817515,0.445296079917,0.426773817515,0.426773817515,0.415418202693,0.415418202693,0.415418202693,0.415418202693,0.415418202693,0.415418202693,0.415418202693,0.415418202693)
M_hpd_m95=c(0.895002390237, 0.895002390237,0.0895830494592,0.0895830494592,0.0895830494592,0.0927142515706,0.0938429591034,0.0938429591034,0.0927142515706,0.0927142515706,0.0927142515706,0.0927142515706,0.0927142515706,0.0927142515706,0.0927142515706,0.0927142515706,0.0927142515706,0.0927142515706,0.0927142515706,0.089360653807,0.0927142515706,0.089360653807,0.0823348638366,0.0694330140622,0.0556837800556,0.0459598763811,0.0432942652613,0.0433873329572,0.044377811818,0.044377811818,0.0433873329572,0.0433873329572,0.044377811818,0.044377811818,0.044377811818,0.044377811818,0.044377811818,0.044377811818,0.044377811818,0.044377811818,0.044377811818,0.044377811818,0.044377811818,0.044377811818,0.044377811818,0.044377811818,0.044377811818,0.044377811818,0.044377811818,0.044377811818,0.044377811818,0.044377811818,0.044377811818,0.044377811818)
M_hpd_M95=c(1.49525476933, 1.49525476933,0.147177628492,0.147177628492,0.147177628492,0.147177628492,0.147177628492,0.147177628492,0.139372423547,0.139372423547,0.139372423547,0.139372423547,0.139372423547,0.139372423547,0.139372423547,0.139372423547,0.139372423547,0.139372423547,0.139372423547,0.138723011533,0.142719036777,0.141710662401,0.1439876771,0.139469861152,0.136541504761,0.132570968559,0.126324184307,0.12526643162,0.12526643162,0.12526643162,0.122392875825,0.122392875825,0.124668784907,0.124668784907,0.124668784907,0.124668784907,0.124668784907,0.124668784907,0.124668784907,0.124668784907,0.124668784907,0.124668784907,0.124668784907,0.124668784907,0.124668784907,0.124668784907,0.124668784907,0.124668784907,0.124668784907,0.124668784907,0.124668784907,0.124668784907,0.124668784907,0.124668784907)
R_hpd_m95=c(-1.2322805417, -1.2322805417,0.028440091164,-0.00022757796382,-0.0513115772357,-0.0705080678257,-0.0750107287909,-0.0823270253213,-0.0750107287909,-0.0750107287909,-0.0750107287909,-0.0750107287909,-0.0750107287909,-0.0750107287909,-0.0750107287909,-0.0733185660557,-0.0720429201165,-0.0577503644539,-0.0447138194876,-0.0386796061678,-0.0382875060722,-0.0285806212196,-0.0333471356099,-0.0265167848833,-0.0280441848921,-0.0285806212196,-0.0285806212196,-0.0199568368162,-0.002410033043,-0.00022757796382,-0.00022757796382,0.0260208584796,0.0260208584796,0.0414723716206,0.0452359796396,0.0586957098689,0.0452359796396,0.0452359796396,0.0586957098689,0.0586957098689,0.0586957098689,0.0586957098689,0.0586957098689,0.0594108673944,-0.0112639647447,-0.0112639647447,-0.0216959328503,-0.0337837499151,-0.0337837499151,-0.0337837499151,-0.0337837499151,-0.0337837499151,-0.0337837499151,-0.0337837499151)
R_hpd_M95=c(-0.552466228257, -0.552466228257,0.270449665477,0.286664570445,0.244973160189,0.207363164717,0.103642681478,0.0433103668413,0.0355694259816,0.028440091164,0.0260346021298,0.0215349409086,0.0215349409086,0.0215349409086,0.0215349409086,0.0326758048439,0.0458037771685,0.0635473448093,0.0706207323399,0.0867370253472,0.0867370253472,0.0887843172082,0.0887843172082,0.101109567185,0.11687652548,0.12180030482,0.132230770077,0.140855442802,0.178470682164,0.242983013522,0.291419921337,0.301125078972,0.306403531419,0.328361396899,0.336452892234,0.35979653669,0.332793489359,0.332793489359,0.357681402253,0.35979653669,0.35979653669,0.357681402253,0.35979653669,0.376502407566,0.35979653669,0.35979653669,0.35396050186,0.35396050186,0.35396050186,0.35396050186,0.35396050186,0.35396050186,0.35396050186,0.35396050186)
L_mean=c(0.268958966754, 0.268958966754,0.272578900217,0.280724237848,0.237833467604,0.175447651125,0.10231637927,0.097101474011,0.0953019171923,0.0937558070865,0.0932557767647,0.0930388581927,0.0930388581927,0.0930541539494,0.0930541539494,0.0950694035449,0.104061983673,0.116145154901,0.123838423111,0.127451324082,0.130120693195,0.136241809342,0.139098561879,0.140553576595,0.145150293276,0.145150293276,0.145681248638,0.146108539524,0.152369191128,0.172826274155,0.236405948889,0.258101102711,0.262675169435,0.27077351278,0.273447178352,0.277502919453,0.279942069286,0.280800186024,0.281553358729,0.281700386229,0.281564704738,0.280385581593,0.282562753666,0.282601117426,0.278099930818,0.275620099934,0.271935880099,0.26887169123,0.26913212893,0.26913212893,0.269054801282,0.268515967676,0.268515967676,0.268515967676)
M_mean=c(1.15482178187, 1.15482178187,0.11918847108,0.11918847108,0.11918847108,0.117867201302,0.117674957007,0.117674957007,0.116641219397,0.116641219397,0.116641219397,0.116641219397,0.116641219397,0.116641219397,0.116641219397,0.116641219397,0.116641219397,0.116650899488,0.116583106079,0.11631037389,0.116480277959,0.116161326318,0.114491347496,0.107012052968,0.0990749650175,0.0919421986027,0.0865895189132,0.0847886835221,0.0827690276412,0.0825845117086,0.0822536970497,0.0822536970497,0.0826050621442,0.0828022125418,0.0828022125418,0.0828022125418,0.0828022125418,0.0828022125418,0.0828022125418,0.0828022125418,0.0828022125418,0.0828022125418,0.0828022125418,0.0828022125418,0.0828022125418,0.0828022125418,0.0828022125418,0.0828022125418,0.0828022125418,0.0828022125418,0.0828022125418,0.0828022125418,0.0828022125418,0.0828022125418)
R_mean=c(-0.885862815114, -0.885862815114,0.153390429137,0.161535766769,0.118644996525,0.0575804498225,-0.0153585777372,-0.020573482996,-0.021339302205,-0.0228854123108,-0.0233854426325,-0.0236023612045,-0.0236023612045,-0.0235870654478,-0.0235870654478,-0.0215718158523,-0.0125792357243,-0.000505744587611,0.00725531703237,0.0111409501918,0.0136404152358,0.0200804830234,0.0246072143828,0.0335415236264,0.0460753282583,0.0532080946731,0.0590917297248,0.0613198560015,0.0696001634873,0.0902417624466,0.15415225184,0.175847405661,0.18007010729,0.187971300239,0.19064496581,0.194700706911,0.197139856744,0.197997973482,0.198751146188,0.198898173688,0.198762492196,0.197583369052,0.199760541124,0.199798904885,0.195297718276,0.192817887392,0.189133667557,0.186069478688,0.186329916389,0.186329916389,0.18625258874,0.185713755134,0.185713755134,0.185713755134)
trans=0.5
age=(0:(54-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.489825687908), xlim = c(-56.7,2.7), ylab = 'Speciation rate', xlab = 'Ma',main='canid' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 1.64478024627), xlim = c(-56.7,2.7), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-1.35550859587, 0.414152648323), xlim = c(-56.7,2.7), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-56.7,2.7), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()