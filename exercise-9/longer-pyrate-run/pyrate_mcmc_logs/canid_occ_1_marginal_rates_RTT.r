# 1 files combined:
# 	/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/longer-pyrate-run/pyrate_mcmc_logs/canid_occ_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/longer-pyrate-run/pyrate_mcmc_logs/canid_occ_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.132209023427, 0.132209023427,0.129576862495,0.128996121894,0.0711831413354,0.0582088529831,0.038649654345,0.0460756570015,0.0466795504766,0.0465688480528,0.0473121886376,0.0473121886376,0.0466795504766,0.0460756570015,0.0465688480528,0.0465688480528,0.0547285420871,0.0624035449059,0.0624035449059,0.0683454321042,0.0727654911096,0.0777616481927,0.0852764464615,0.0864218615639,0.0916142699233,0.0913369455137,0.0915019884242,0.0903994072692,0.0911352370493,0.0893464956804,0.102788157496,0.11932310829,0.136658389038,0.138486831656,0.13266423522,0.135298015063,0.136658389038,0.147806884931,0.147806884931,0.147806884931,0.120390989408,0.115120339404,0.109508290877,0.105505836025,0.105505836025,0.0982604651848,0.0645747041876,0.0559360197145,0.0532078420948,0.0532078420948,0.0532078420948,0.0532078420948,0.0532078420948,0.0532078420948)
L_hpd_M95=c(0.355845211797, 0.355845211797,0.355272571241,0.367483110412,0.351493033033,0.31821946193,0.160647474539,0.13822366196,0.136911111486,0.135628134989,0.135971807985,0.135971807985,0.135799450498,0.135628134989,0.136911111486,0.138916161354,0.160650126121,0.172682063932,0.175090387801,0.183155286495,0.192131458682,0.20457681151,0.212018210309,0.214301715607,0.220783683502,0.220783683502,0.220783683502,0.220783683502,0.228788504228,0.286639169868,0.369403450712,0.383143712491,0.397795360384,0.402925583563,0.405568603627,0.409490827322,0.409987111767,0.423455872582,0.424920220754,0.430487747374,0.410367616854,0.407488766311,0.405568603627,0.405402232427,0.42555765879,0.430487747374,0.405402232427,0.405568603627,0.406227910978,0.409043406881,0.409043406881,0.409043406881,0.409043406881,0.409043406881)
M_hpd_m95=c(0.85653579099, 0.85653579099,0.0855480796649,0.0855480796649,0.0855480796649,0.0855480796649,0.0855480796649,0.0855480796649,0.0855480796649,0.0855480796649,0.0855480796649,0.0845818808022,0.0855480796649,0.0855480796649,0.08529439248,0.08529439248,0.0855480796649,0.0855480796649,0.0855480796649,0.0855480796649,0.0855480796649,0.0855480796649,0.0855480796649,0.0855480796649,0.0855480796649,0.08529439248,0.0855480796649,0.0855480796649,0.08529439248,0.0847779970927,0.0845295247274,0.0845295247274,0.0844584421761,0.0844584421761,0.082560117645,0.0844584421761,0.0844584421761,0.0844584421761,0.0844584421761,0.0844584421761,0.0844584421761,0.0844584421761,0.0844584421761,0.0844584421761,0.0844584421761,0.0844584421761,0.0844584421761,0.0844584421761,0.0844584421761,0.0844584421761,0.0844584421761,0.0844584421761,0.0844584421761,0.0844584421761)
M_hpd_M95=c(1.48911108898, 1.48911108898,0.144044777353,0.144044777353,0.144044777353,0.143736759756,0.143487210769,0.141444834386,0.13873355977,0.136622585623,0.134544413415,0.130663875369,0.128833557576,0.127103551547,0.125434001337,0.124913659347,0.124913659347,0.124913659347,0.124811370573,0.124811370573,0.124913659347,0.124811370573,0.124811370573,0.124913659347,0.124913659347,0.124913659347,0.125434001337,0.125545942391,0.125434001337,0.125378236364,0.125434001337,0.125434001337,0.125434001337,0.125434001337,0.125378236364,0.128891279376,0.128891279376,0.128891279376,0.128891279376,0.128891279376,0.128891279376,0.128891279376,0.128891279376,0.128891279376,0.128891279376,0.128891279376,0.128891279376,0.128891279376,0.128891279376,0.128891279376,0.128891279376,0.128891279376,0.128891279376,0.128891279376)
R_hpd_m95=c(-1.26353734112, -1.26353734112,0.0269105748421,0.0269105748421,-0.0453450069205,-0.0646770302674,-0.0909694225301,-0.0745082166196,-0.073460288643,-0.0706907775572,-0.0696009504979,-0.0668583538241,-0.0668583538241,-0.0667257828212,-0.0667257828212,-0.0578258862662,-0.0568029502556,-0.0454140726108,-0.04234038411,-0.04234033048,-0.0420502197238,-0.0326012872748,-0.0245784351506,-0.0206167024054,-0.0185085409692,-0.0186438101785,-0.0185085409692,-0.0186438101785,-0.0186438101785,-0.0229821820222,-0.00379471338376,0.0163883953667,0.0160964637508,0.0317683845826,0.0321450022507,0.0317683845826,0.0317683845826,0.0309164888544,0.0292729405772,0.0269326848798,0.0195264264511,0.0172727984407,0.0116076706561,0.00214314007906,-0.0147822046276,-0.029739440752,-0.038820857123,-0.0407082550884,-0.0435260170506,-0.0418910432464,-0.0418910432464,-0.0418910432464,-0.0418910432464,-0.0418910432464)
R_hpd_M95=c(-0.598971066271, -0.598971066271,0.257791282473,0.271095655724,0.244953634815,0.21350948442,0.0683009618922,0.0373137856536,0.0343617626743,0.0343617626743,0.0343617626743,0.0362428218495,0.0357000035197,0.0343672136837,0.0343672136837,0.043500563702,0.0562661761045,0.0726177689426,0.0765470834861,0.0780706924097,0.0855574094862,0.100248521883,0.109401010698,0.116714360305,0.121225352373,0.121776198032,0.121744627369,0.1219779377,0.128562562883,0.184162593657,0.2659962801,0.282880697435,0.28429031118,0.302884800298,0.308858416302,0.307445585581,0.307445585581,0.308858416302,0.308496166731,0.311567738319,0.308858416302,0.311567738319,0.311567738319,0.30805176862,0.310764734681,0.311271311299,0.305278480616,0.311567738319,0.311567738319,0.317870055818,0.317870055818,0.317870055818,0.317870055818,0.317870055818)
L_mean=c(0.270441227482, 0.270441227482,0.271768586066,0.275630363107,0.242714939129,0.171683396532,0.0993348949807,0.0941513776719,0.0934786991268,0.0930140806321,0.0927654908783,0.0929441821344,0.0936830435832,0.093832216799,0.0940912289822,0.0948596054753,0.102528050401,0.110985436375,0.116103243884,0.120308855278,0.127273549694,0.137583017325,0.14206275908,0.146574771025,0.150547252506,0.150938172926,0.150878818852,0.151370216068,0.153700878037,0.171698659623,0.229227214499,0.252407262915,0.258017002352,0.264980115294,0.273393383585,0.274057902777,0.272997967601,0.273064945131,0.272859187084,0.271672175132,0.270271451357,0.26832489726,0.266623264381,0.263724387436,0.258215922656,0.25514714277,0.251087979801,0.247815612908,0.248179971575,0.248099943054,0.248126423382,0.248004796524,0.247778565933,0.247539548143)
M_mean=c(1.17576596341, 1.17576596341,0.111670633946,0.111672662757,0.111663922949,0.111566006926,0.111298476321,0.110784283406,0.110270751874,0.109722964245,0.109277082457,0.108529765367,0.10800336963,0.10735485099,0.106748232214,0.106298404388,0.106107847062,0.105944398958,0.105922303516,0.105922303516,0.105910379624,0.105894602882,0.10589268269,0.10588820141,0.10588820141,0.105771980003,0.105619711081,0.105608666089,0.105574245017,0.105537557022,0.10550982878,0.10550982878,0.105487578874,0.10553171982,0.105147921478,0.104764057346,0.104764057346,0.104764057346,0.104764057346,0.104764057346,0.104764057346,0.104764057346,0.104764057346,0.104764057346,0.104764057346,0.104764057346,0.104764057346,0.104764057346,0.104764057346,0.104764057346,0.104764057346,0.104764057346,0.104764057346,0.104764057346)
R_mean=c(-0.905324735925, -0.905324735925,0.16009795212,0.16395770035,0.13105101618,0.0601173896065,-0.0119635813401,-0.0166329057345,-0.0167920527474,-0.0167088836125,-0.0165115915783,-0.0155855832321,-0.0143203260471,-0.013522634191,-0.0126570032317,-0.0114387989127,-0.00357979666018,0.00504103741702,0.0101809403688,0.0143865517622,0.0213631700705,0.0316884144436,0.0361700763895,0.0406865696148,0.0446590510961,0.045166192923,0.045259107771,0.0457615499796,0.0481266330192,0.0661611026013,0.123717385719,0.146897434134,0.152529423478,0.159448395474,0.168245462107,0.169293845431,0.168233910255,0.168300887785,0.168095129739,0.166908117787,0.165507394012,0.163560839915,0.161859207036,0.15896033009,0.153451865311,0.150383085424,0.146323922455,0.143051555562,0.143415914229,0.143335885709,0.143362366036,0.143240739179,0.143014508588,0.142775490797)
trans=0.5
age=(0:(54-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.473536522112), xlim = c(-56.7,2.7), ylab = 'Speciation rate', xlab = 'Ma',main='canid' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 1.63802219787), xlim = c(-56.7,2.7), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-1.38989107523, 0.3496570614), xlim = c(-56.7,2.7), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-56.7,2.7), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()